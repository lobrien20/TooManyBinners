BootStrap: debootstrap
OSVersion: stable
MirrorURL: http://ftp.us.debian.org/debian/

%environment
    PATH=/opt/mamba/bin:$PATH
    PATH=/opt/:$PATH
%post

    # apt repository installs...
    apt-get update
    apt-get update && apt-get install -y wget git bash gcc gfortran g++ make file python3 nano curl


    # conda obtaining
	# Install Mamba (Conda alternative) through Mambaforge
	readonly mamba_installer="Mambaforge-$(uname)-$(uname -m).sh"
	readonly mamba_version="4.10.3-4"
	readonly mamba_prefix="/opt/mamba"
	wget "https://github.com/conda-forge/miniforge/releases/download/${mamba_version}/${mamba_installer}"
	bash "${mamba_installer}" -b -p "${mamba_prefix}"
    PATH=/opt/mamba/bin:$PATH
	rm "${mamba_installer}"


    mamba install -c conda-forge psutil
    mamba create -n prebinning -c bioconda bowtie2 samtools spades
    mamba create -n CONCOCTMetabat2MaxBin2SemiBin2 -c conda-forge -c bioconda concoct maxbin2 metabat2 semibin

    mamba create -n Vamb4 pip
    bash -c "source /opt/mamba/bin/activate Vamb4 && pip install vamb"
#


%runscript
